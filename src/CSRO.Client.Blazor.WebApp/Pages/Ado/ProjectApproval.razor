@page "/ado/ProjectApproval"
@inherits ProjectApprovalBase
@using CSRO.Common.AdoServices.Models;


<MudContainer MaxWidth="MaxWidth.ExtraLarge" Class="mt-6">
    <MudText Typo="Typo.h4" GutterBottom="true">@Tickets?.Count Projects are awaiting approval to be created.</MudText>
    @if (IsLoading)
    {
        <MudGrid>
            <MudItem>
                <MudProgressCircular Color="Color.Default" Indeterminate="true" />
            </MudItem>
            <MudItem>
                <MudText>@LoadingMessage</MudText>
            </MudItem>
        </MudGrid>
    }       
    <MudGrid>
        <MudItem>
            <MudButton Disabled="@IsButtonDisabled" ButtonType="ButtonType.Submit" Variant="Variant.Filled"
                       OnClick="ApproveAsync"
                       Color="Color.Primary" Class="ml-auto">Approve</MudButton>
        </MudItem>
        <MudItem>
            <MudButton Disabled="@IsButtonDisabled" ButtonType="ButtonType.Reset" Variant="Variant.Filled"
                       OnClick="RejectAsync"
                       Color="Color.Error" Class="ml-auto">Reject</MudButton>
        </MudItem>
    </MudGrid>

    <MudText Class="mt-6"
                Inline="true">Selected items: @(selectedItems==null ? "" : string.Join(", ", selectedItems.OrderBy(x=>x.Name).Select(x=>x.Name)))</MudText>

    <MudTable MultiSelection="true"
                @bind-SelectedItems="selectedItems"
                Items="Tickets"
                Hover="true" SortLabel="Sort By" Elevation="0">
        <HeaderContent>
            <MudTh><MudTableSortLabel SortBy="new Func<ProjectAdo, object>(x=>x.Id)">Id</MudTableSortLabel></MudTh>
            @*<MudTh><MudTableSortLabel SortBy="new Func<ProjectAdo, object>(x=>x.State)">State</MudTableSortLabel></MudTh>*@
            <MudTh><MudTableSortLabel SortBy="new Func<ProjectAdo, object>(x=>x.Organization)">Organization</MudTableSortLabel></MudTh>
            <MudTh><MudTableSortLabel SortBy="new Func<ProjectAdo, object>(x=>x.Name)">Name</MudTableSortLabel></MudTh>
            <MudTh><MudTableSortLabel SortBy="new Func<ProjectAdo, object>(x=>x.Description)">Description</MudTableSortLabel></MudTh>
            <MudTh><MudTableSortLabel SortBy="new Func<ProjectAdo, object>(x=>x.ProcessName)">Process</MudTableSortLabel></MudTh>
            <MudTh><MudTableSortLabel SortBy="new Func<ProjectAdo, object>(x=>x.CreatedBy)">Created By</MudTableSortLabel></MudTh>
            <MudTh><MudTableSortLabel InitialDirection="SortDirection.Ascending" SortBy="new Func<ProjectAdo, object>(x=>x.CreatedAt)">Created At</MudTableSortLabel></MudTh>
            <MudTh><MudTableSortLabel InitialDirection="SortDirection.Ascending" SortBy="new Func<ProjectAdo, object>(x=>x.ModifiedAt)">ModifiedAt At</MudTableSortLabel></MudTh>
        </HeaderContent>
        <RowTemplate>
            <MudTd DataLabel="Id">@context.Id</MudTd>
            @*<MudTd DataLabel="State">@context.State</MudTd>*@
            <MudTd DataLabel="Organization">@context.Organization</MudTd>
            <MudTd DataLabel="Name">@context.Name</MudTd>
            <MudTd DataLabel="Description">@context.Description</MudTd>
            <MudTd DataLabel="Process">@context.ProcessName</MudTd>
            <MudTd DataLabel="Created By">@context.CreatedBy</MudTd>
            <MudTd DataLabel="Created At">@context.CreatedAt</MudTd>
            <MudTd DataLabel="Modified At">@context.ModifiedAt</MudTd>
        </RowTemplate>
        <PagerContent>
            <MudTablePager PageSizeOptions="new int[]{10, 20, 50}" />
        </PagerContent>
    </MudTable>
    
</MudContainer>